# LLM Observatory Storage Configuration
# Copy this file to .env and update with your actual values

# ========================================
# PostgreSQL Configuration (Required)
# ========================================

# Option 1: Use a full DATABASE_URL (recommended for production)
# DATABASE_URL=postgresql://username:password@localhost:5432/llm_observatory?sslmode=prefer&application_name=llm-observatory

# Option 2: Use individual PostgreSQL settings
DB_HOST=localhost
DB_PORT=5432
DB_NAME=llm_observatory
DB_USER=postgres
DB_PASSWORD=your_password_here

# SSL Mode: disable, allow, prefer, require, verify-ca, verify-full
DB_SSL_MODE=prefer

# Application name for connection tracking
DB_APP_NAME=llm-observatory

# ========================================
# Redis Configuration (Optional)
# ========================================

# Redis connection URL (optional, for caching and real-time features)
# REDIS_URL=redis://localhost:6379/0
# REDIS_URL=rediss://localhost:6380/0  # For SSL/TLS

# Redis pool size (default: 10)
# REDIS_POOL_SIZE=10

# Redis connection timeout in seconds (default: 5)
# REDIS_TIMEOUT_SECS=5

# ========================================
# Connection Pool Configuration
# ========================================

# Maximum number of connections in the pool (default: 50)
DB_POOL_MAX_CONNECTIONS=50

# Minimum number of idle connections (default: 5)
DB_POOL_MIN_CONNECTIONS=5

# Connection timeout in seconds (default: 10)
DB_POOL_CONNECT_TIMEOUT=10

# Idle connection timeout in seconds (default: 300 = 5 minutes)
DB_POOL_IDLE_TIMEOUT=300

# Maximum connection lifetime in seconds (default: 1800 = 30 minutes)
DB_POOL_MAX_LIFETIME=1800

# ========================================
# Retry Configuration
# ========================================

# Maximum number of retry attempts (default: 3)
DB_RETRY_MAX_ATTEMPTS=3

# Initial retry delay in milliseconds (default: 100)
DB_RETRY_INITIAL_DELAY_MS=100

# Maximum retry delay in milliseconds (default: 5000)
DB_RETRY_MAX_DELAY_MS=5000

# Backoff multiplier for exponential backoff (default: 2.0)
DB_RETRY_BACKOFF_MULTIPLIER=2.0

# ========================================
# Logging Configuration
# ========================================

# Set log level (error, warn, info, debug, trace)
RUST_LOG=info

# For more detailed storage logs
# RUST_LOG=llm_observatory_storage=debug,sqlx=debug

# ========================================
# Example Configurations
# ========================================

# Development (local PostgreSQL)
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=llm_observatory_dev
# DB_USER=postgres
# DB_PASSWORD=postgres
# DB_SSL_MODE=disable
# REDIS_URL=redis://localhost:6379/0

# Production (AWS RDS example)
# DATABASE_URL=postgresql://admin:strong_password@llm-obs-prod.xxxxx.us-east-1.rds.amazonaws.com:5432/llm_observatory?sslmode=require
# REDIS_URL=rediss://llm-obs-prod.cache.amazonaws.com:6380/0
# DB_POOL_MAX_CONNECTIONS=100
# DB_POOL_MIN_CONNECTIONS=10

# Docker Compose
# DB_HOST=postgres
# DB_PORT=5432
# DB_NAME=llm_observatory
# DB_USER=postgres
# DB_PASSWORD=postgres
# REDIS_URL=redis://redis:6379/0
