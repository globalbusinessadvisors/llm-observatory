# LLM Observatory - Environment Configuration
# Copy this file to .env and update with your actual values

# =============================================================================
# TimescaleDB Configuration
# =============================================================================

# Database connection settings
DB_HOST=localhost
DB_PORT=5432
DB_NAME=llm_observatory
DB_USER=postgres
DB_PASSWORD=postgres

# Application database user (created by init script)
DB_APP_USER=llm_observatory_app
DB_APP_PASSWORD=change_me_in_production

# Read-only database user (created by init script)
DB_READONLY_USER=llm_observatory_readonly
DB_READONLY_PASSWORD=change_me_readonly

# Database connection string templates
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}
DATABASE_APP_URL=postgresql://${DB_APP_USER}:${DB_APP_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}
DATABASE_READONLY_URL=postgresql://${DB_READONLY_USER}:${DB_READONLY_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# PostgreSQL performance tuning (adjust based on available memory)
DB_SHARED_BUFFERS=256MB
DB_WORK_MEM=32MB
DB_MAINTENANCE_WORK_MEM=128MB
DB_EFFECTIVE_CACHE_SIZE=1GB

# Connection pool settings (for application)
DB_POOL_MIN_SIZE=5
DB_POOL_MAX_SIZE=20
DB_POOL_TIMEOUT=30
DB_POOL_IDLE_TIMEOUT=300
DB_POOL_MAX_LIFETIME=1800

# =============================================================================
# Redis Configuration
# =============================================================================

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis_password
REDIS_DB=0

# Redis connection string
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Cache TTL settings (in seconds)
CACHE_DEFAULT_TTL=3600
CACHE_SHORT_TTL=300
CACHE_LONG_TTL=86400

# =============================================================================
# Grafana Configuration
# =============================================================================

GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ROOT_URL=http://localhost:3000
GRAFANA_DOMAIN=localhost

# Grafana database settings (uses TimescaleDB for metadata)
GRAFANA_DB_NAME=grafana

# Anonymous access (set to true for public dashboards)
GRAFANA_ANONYMOUS_ENABLED=false

# Optional: Grafana plugins to install (comma-separated)
# Example: grafana-clock-panel,grafana-simple-json-datasource
GRAFANA_PLUGINS=

# =============================================================================
# PgAdmin Configuration (Optional - use with --profile admin)
# =============================================================================

PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@llm-observatory.local
PGADMIN_PASSWORD=admin

# =============================================================================
# Application Configuration
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Application server settings
APP_HOST=0.0.0.0
APP_PORT=8080

# Logging configuration
LOG_LEVEL=info
LOG_FORMAT=json

# =============================================================================
# Storage Service Configuration
# =============================================================================

# Storage service ports
STORAGE_API_PORT=8082
STORAGE_METRICS_PORT=9092

# Storage service logging
STORAGE_RUST_LOG=info,llm_observatory_storage=debug,sqlx=warn

# COPY protocol settings (batch writing optimization)
COPY_BATCH_SIZE=10000
COPY_FLUSH_INTERVAL=1000
COPY_BUFFER_SIZE=8192
COPY_MAX_RETRIES=3
COPY_RETRY_DELAY_MS=100

# Data retention policies (in days)
RETENTION_TRACES_DAYS=30
RETENTION_METRICS_DAYS=90
RETENTION_LOGS_DAYS=7

# Migration control
SKIP_MIGRATIONS=false

# =============================================================================
# API Service Configuration
# =============================================================================

# API ports
API_PORT=8080
API_METRICS_PORT=9091
API_DEV_PORT=8081
API_DEV_METRICS_PORT=9093

# GraphQL configuration
GRAPHQL_ENABLED=true
GRAPHQL_PLAYGROUND=false
GRAPHQL_PLAYGROUND_PORT=5555
GRAPHQL_INTROSPECTION=false
GRAPHQL_MAX_DEPTH=10
GRAPHQL_MAX_COMPLEXITY=1000

# API rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# CORS settings
CORS_MAX_AGE=3600

# =============================================================================
# Security Configuration
# =============================================================================

# Secret key for encryption/signing (generate with: openssl rand -hex 32)
SECRET_KEY=change_me_to_a_random_secret_key_in_production

# JWT settings (if using authentication)
JWT_SECRET=change_me_to_a_random_jwt_secret
JWT_ALGORITHM=HS256
JWT_EXPIRATION=3600

# CORS settings (comma-separated origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# =============================================================================
# LLM Provider Configuration (placeholder for future use)
# =============================================================================

# OpenAI
OPENAI_API_KEY=
OPENAI_ORG_ID=

# Anthropic
ANTHROPIC_API_KEY=

# AWS Bedrock
AWS_REGION=
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# Azure OpenAI
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_ENDPOINT=

# =============================================================================
# Storage Service Configuration
# =============================================================================

# Storage service ports
STORAGE_METRICS_PORT=9092
STORAGE_HEALTH_PORT=8081

# Storage configuration
STORAGE_BATCH_SIZE=1000
STORAGE_FLUSH_INTERVAL=5
STORAGE_COMPRESSION_ENABLED=true

# Storage logging
STORAGE_LOG_LEVEL=info

# =============================================================================
# Collector Service Configuration
# =============================================================================

# Collector OTLP endpoints (different from Jaeger ports)
COLLECTOR_OTLP_GRPC_PORT=4327
COLLECTOR_OTLP_HTTP_PORT=4328
COLLECTOR_METRICS_PORT=9091
COLLECTOR_HEALTH_PORT=8082

# Development collector ports (for --profile dev)
COLLECTOR_DEV_OTLP_GRPC_PORT=4337
COLLECTOR_DEV_OTLP_HTTP_PORT=4338
COLLECTOR_DEV_METRICS_PORT=9191
COLLECTOR_DEV_HEALTH_PORT=8182

# Collector batch processing
COLLECTOR_BATCH_SIZE=500
COLLECTOR_BATCH_TIMEOUT=10
COLLECTOR_MAX_QUEUE_SIZE=10000
COLLECTOR_NUM_WORKERS=4

# LLM-specific processing features
COLLECTOR_LLM_ENRICHMENT_ENABLED=true
COLLECTOR_TOKEN_COUNTING_ENABLED=true
COLLECTOR_COST_CALCULATION_ENABLED=true
COLLECTOR_PII_REDACTION_ENABLED=false

# Collector logging
COLLECTOR_LOG_LEVEL=info
COLLECTOR_LOG_FORMAT=json

# OpenTelemetry protocol settings
OTLP_COMPRESSION=gzip
OTLP_TIMEOUT=30
OTLP_MAX_MESSAGE_SIZE=4194304

# =============================================================================
# Monitoring & Observability
# =============================================================================

# Prometheus - Metrics collection and storage
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=30d

# Alertmanager - Alert routing and notification
ALERTMANAGER_PORT=9093

# Jaeger - Distributed tracing
JAEGER_UI_PORT=16686
JAEGER_OTLP_GRPC_PORT=4317
JAEGER_OTLP_HTTP_PORT=4318
JAEGER_COMPACT_PORT=6831
JAEGER_BINARY_PORT=6832
JAEGER_GRPC_PORT=14250
JAEGER_COLLECTOR_PORT=14268

# Loki - Log aggregation
LOKI_PORT=3100

# Exporters - Metrics exporters for infrastructure services
POSTGRES_EXPORTER_PORT=9187
REDIS_EXPORTER_PORT=9121
NODE_EXPORTER_PORT=9100

# Enable metrics endpoint (application services)
METRICS_ENABLED=true
METRICS_PORT=9090

# Enable health check endpoint
HEALTH_CHECK_ENABLED=true

# Sentry (error tracking - optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=${ENVIRONMENT}

# =============================================================================
# Development Settings
# =============================================================================

# Auto-reload on code changes
AUTO_RELOAD=true

# Debug mode
DEBUG=false

# Database query logging
DB_QUERY_LOGGING=false

# =============================================================================
# Backup Configuration
# =============================================================================

# Backup retention period (days)
BACKUP_RETENTION=30

# S3 backup configuration (optional)
S3_BACKUP_BUCKET=
S3_BACKUP_PREFIX=backups/
S3_STORAGE_CLASS=STANDARD_IA
S3_KMS_KEY_ID=

# WAL archiving configuration (for Point-in-Time Recovery)
WAL_ARCHIVE_DIR=/var/lib/postgresql/wal_archive
WAL_S3_BUCKET=
WAL_S3_PREFIX=wal_archive/
WAL_RETENTION_DAYS=7

# Notification email for backup alerts
NOTIFICATION_EMAIL=

# =============================================================================
# Docker Compose Settings
# =============================================================================

# Compose project name (for container/volume naming)
COMPOSE_PROJECT_NAME=llm-observatory
